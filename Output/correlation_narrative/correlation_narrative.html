<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Narrative: NYC Public Schools Absenteeism</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 960px;
            margin: 0 auto;
            padding: 2rem;
        }

        #bottom_text_area {
            color: white;
        }

        h1,
        h2,
        h3 {
            color: white;
        }

        p {
            color: white;
            line-height: 1.6;
        }

        .figure-container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        figure {
            margin: 0;
            padding: 0;
            width: calc(33.33% - 20px);
            /* Adjust the percentage and subtract the margin for proper alignment */
            text-align: center;
            box-sizing: border-box;
            margin-bottom: 20px;
            /* Add some space below each figure */
        }

        .container {
            display: flex;
            justify-content: center;
            flex-wrap: nowrap;
        }

        /* .container::after {
            content: "";
            display: table;
            clear: both;
        } */

        .image-container {
            position: relative;
            display: inline-block;
            /* width: 320px; */
            /* height: 240px; */
            width: 33%;
        }

        .image-container img {
            position: block;
            top: 0;
            left: 0;
            max-width: 100%;
            height: auto;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        figcaption {
            font-size: 14px;
            padding-top: 10px;
        }

        /* Add custom styling for the button */
        button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 12px 24px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 4px;
            transition-duration: 0.4s;
        }

        button:hover {
            background-color: #45a049;
            box-shadow: 0 12px 16px 0 rgba(0, 0, 0, 0.24), 0 17px 50px 0 rgba(0, 0, 0, 0.19);
        }
    </style>
    <script>
        function switchImage1() {
            const scatterplotImage = document.getElementById('scatterplot1');
            const regressionImage = document.getElementById('regression1');
            const switchButton = document.getElementById('btn1');
            const reg_text = document.getElementById('reg_text1');


            if (scatterplotImage.style.display === 'none') {
                scatterplotImage.style.display = 'block';
                regressionImage.style.display = 'none';
                switchButton.textContent = 'Show Regression';
                reg_text.style.display = 'none';
            } else {
                scatterplotImage.style.display = 'none';
                regressionImage.style.display = 'block';
                switchButton.textContent = 'Hide Regression';
                reg_text.style.display = 'block';
            }
        }

        function switchImage2() {
            const scatterplotImage = document.getElementById('scatterplot2');
            const regressionImage = document.getElementById('regression2');
            const switchButton = document.getElementById('btn2');
            const reg_text = document.getElementById('reg_text2');


            if (scatterplotImage.style.display === 'none') {
                scatterplotImage.style.display = 'block';
                regressionImage.style.display = 'none';
                switchButton.textContent = 'Show Regressions';
                reg_text.style.display = 'none';
            } else {
                scatterplotImage.style.display = 'none';
                regressionImage.style.display = 'block';
                switchButton.textContent = 'Hide Regressions';
                reg_text.style.display = 'block';
            }
        }

        function switchImage3() {
            const scatterplotImage = document.getElementById('scatterplot3');
            const regressionImage = document.getElementById('regression3');
            const switchButton = document.getElementById('btn3');
            const reg_text = document.getElementById('reg_text3');


            if (scatterplotImage.style.display === 'none') {
                scatterplotImage.style.display = 'block';
                regressionImage.style.display = 'none';
                switchButton.textContent = 'Show Regressions';
                reg_text.style.display = 'none';
            } else {
                scatterplotImage.style.display = 'none';
                regressionImage.style.display = 'block';
                switchButton.textContent = 'Hide Regressions';
                reg_text.style.display = 'block';
            }
        }

        function switchImage4() {
            const scatterplotImage = document.getElementById('scatterplot4');
            const regressionImage = document.getElementById('regression4');
            const switchButton = document.getElementById('btn4');
            const reg_text = document.getElementById('reg_text4');


            if (scatterplotImage.style.display === 'none') {
                scatterplotImage.style.display = 'block';
                regressionImage.style.display = 'none';
                switchButton.textContent = 'Show Regression';
                reg_text.style.display = 'none';
            } else {
                scatterplotImage.style.display = 'none';
                regressionImage.style.display = 'block';
                switchButton.textContent = 'Hide Regression';
                reg_text.style.display = 'block';
            }
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <h1>Attendance Rate and Student Performance</h1>

    <p>
        It is important to examine student attendance rate due to its correlation with student academic performance.
        To obtain a comprehensive understanding, it is also important to consider potential confounding variables, such as time period and demographics. 
        <br>
        In this page, we present the same scatterplot from a variety of perspectives to explore the relationship between attendance rate and test scores. 
        Each point on the scatterplot represents one district in a given year (2018, 2019, or 2022). The y-axis represents student performance, or more specifically the percentage of students in 
        a district who scored a 3 or 4 (out of 4) on the math state assessment. The x-axis represents a district's attendance rate for that year.
        <br>
        While regression analysis is insufficient to determine the causal relationship between attendance rate and student performance, we will use it as a tool
        for understanding correlations between our variables of interest.  

    </p>

    <h2>Attendance Rate and Test Scores are Significantly Related</h2>

    <p>
        Without considering moderating variables, regression analysis indicates that there is a significant positive relationship between attendance rate and test scores. 
        This highlights the importance of examining attendance rate in NYC public schools and is the main motivation for this project. 

    </p>

    <div>
        <img src="attendance_vs_math_all.png" alt="A description of the image" id="scatterplot1" />
        <img src="attendance_vs_math_all_regplot.png" alt="A description of the image" id="regression1"
            style="display:none;" />
    </div>

    <p id="reg_text1" style="display:none;">
        Assuming the model \(\widehat{score} = \beta_0 + \beta_1 * attendance\), 
        the estimated regression is \(\widehat{score} = -335 + 4.2 * attendance\).
        The slope coefficient (4.2) is statistically significant at strict levels of confidence,
        indicating that there is a significant positive correlation between attendance rate and test scores. 
        <br>
        The slope coefficent tells us that on average, 
        a one percent increase in attendance corresponds to more than a four percent increase in the proportion of 
        students scoring a 3 or 4 on the math state assessment. 
        <br>
        

    </p>

    <button onclick="switchImage1()" id="btn1">Show Regression</button>

    <!-- <div id="bottom_text_area"> -->
    <div>
        <h2>This Relationship Between Attendance Rate and Test Scores Persists Over Time</h2>
        <p>Since we are looking at several years of data on the same scatterplot, we must also examine whether the same relationship
        holds across time. 
        The math state assessment was redesigned in 2018 and due to the pandemic, it was not administered in 2020 and 2021. 
        Therefore, the dataset of test scores only includes data from the years 2018, 2019, and 2022.
        <br>
        To see if the relationship between test scores and attendance rate differ from year to year, we can group the points in the scatterplot
        by year. 
        <br> Regression analysis for each year indicates that this relationship remained consistent over the years, despite 
        the fact that attendance rate decreased during the pandemic.  
        </p>
    </div>
    <br>
    <div>
        <img src="attendance_vs_math_year_scatter.png" alt="A description of the image" id="scatterplot4" />
        <img src="attendance_vs_math_year_reg.png" alt="A description of the image" id="regression4"
            style="display:none;" />
    </div>

    <p id="reg_text4" style="display:none;">
        Regression analysis for each year of data yields similar slope coefficients. This
        suggests that the relationship between attendance rate and test scores for a district remained relatively consistent
        over the years. However, the y-intercept also increased from 2018 to 2022, indicating that attendance 
        rate decreased from 2018 to 2022. Taken together, the results suggest that the relationship between attendance rate 
        and test scores remained consistent over the years despite attendance rate decreasing. 

        <br>
        For 2018, the regression is:
        <br>
        \[\widehat{score} = -465 + 5.55 * attendance \]

        <br>
        For 2019, the regression is:
        <br>
        \[\widehat{score} = -453 + 5.45 * attendance \]

        <br>
        For 2022, the regression is:
        <br>
        \[\widehat{score} = -447 + 5.50 * attendance \]

    </p>

    <button onclick="switchImage4()" id="btn4">Show Regression</button>


    <h2>The Relationship Between Attendance Rate and Test Scores Persists Across Different Demographics</h2>

    <p>
        <!-- [Section 2: Analyze the relationship between absenteeism and test scores, using data to support your findings.] -->

    </p>

    <p>
        While there is a significant relationship between attendance rate and test scores, both variables are also 
        correlated with demographic variables, such as membership in certain minority groups and lower income households. 
        Chronic absenteeism, which is defined as students who miss more than 10% of school days, is also (unsurprisingly) linked to attendance rate and test scores. 
        <br>
        In this section, we group the data points by the following variables: Black/Hispanic, poverty, and chronically absent.
        The variables are binary and represent whether a district in a given year consists of greater than the median percentage of that demographic. 
        The role of these three variables on attendance rate and test scores is apparent in the distribution of the points on the lower end of both axes, 
        which suggests that being in these demographic groups is correlated with lower test scores and lower attendance rate. 
        <br>
        <br>
        Note: The cutoffs for each demographic variable were chosen as the median value for the variable across all
        districts and years.
    </p>
    <div class="container" id="scatterplot2">
        <div class="image-container">
            <img src="attendance_vs_math_is_black_hispanic_regplot=False.png" alt="Image 1 description" />
        </div>

        <div class="image-container">
            <img src="attendance_vs_math_is_poverty_regplot=False.png" alt="Image 2 description" />
        </div>

        <div class="image-container">
            <img src="attendance_vs_math_high_chronic_absenteeism_regplot=False.png" alt="Image 3 description" />
        </div>
    </div>

    <div class="container" id="regression2" style="display:none;">
        <div class="image-container">
            <img src="attendance_vs_math_is_black_hispanic_custom_reg.png" alt="Image 1 description" />
        </div>

        <div class="image-container">
            <img src="attendance_vs_math_is_poverty_custom_reg.png" alt="Image 2 description" />
        </div>

        <div class="image-container">
            <img src="attendance_vs_math_high_chronic_absenteeism_custom_reg.png" alt="Image 3 description" />
        </div>
    </div>

    <p id="reg_text2" style="display:none;">
        In our regression analysis, we control for the demographic variables to see if the relationship between 
        attendance rate and test scores still holds.  
        To do so, we can retain the same linear model as before and add a third term to account for the demographic variable. 
        We estimate the following model for each group:
        <br>
        \[score = \beta_0 + \beta_1 * attendance + \beta_2 * demographic\_variable \]
        <br>
        The estimated regressions are:
        <br>
        \[\widehat{score} = -156 + 2.3 * attendance - 17.8 * black\_hispanic \]
        <br>
        \[\widehat{score} = -219 + 3.0 * attendance - 14.8 * poverty \]
        <br>
        \[\widehat{score} = -318 + 4.0 * attendance - 1.1 * chronic\_absenteeism \]
        <br>
        
        The blue lines in the plot represents the regression of the group of students that don't fall within the specific demographic, 
        and the orange lines in the plot represent the group of students that fall within the demographic. 
        <br>
        From these regressions, we can see that districts with a higher percentage of Black and Hispanic students and 
        students in poverty tended to have a smaller percentage of students scoring a 3 or 4 on
        the exam.
        In addition, districts with a higher percentage of chronically absent students tended score consistently with the predicted 
        score from attendance rate. 
    </p>

    <button onclick="switchImage2()" id="btn2">Show Regressions</button>


    <br>
    <h2>The Relationship Between Attendance Rate and Test Scores is Moderated by Demographic Variabless</h2>

    <!-- <p>
        [Section 3: Explore the demographic disparities related to absenteeism, such as differences among race, gender,
        and socioeconomic status.]
    </p> -->

    <p>
        While the relationship betwen attendance rate and test scores persists across different demographic groups, 
        the demographic variables seem to play a moderating role. 
    </p>

    <div class="container" id="scatterplot3">
        <div class="image-container">
            <img src="attendance_vs_math_is_black_hispanic_regplot=False.png" alt="Image 1 description" />
        </div>

        <div class="image-container">
            <img src="attendance_vs_math_is_poverty_regplot=False.png" alt="Image 2 description" />
        </div>

        <div class="image-container">
            <img src="attendance_vs_math_high_chronic_absenteeism_regplot=False.png" alt="Image 3 description" />
        </div>
    </div>

    <div class="container" id="regression3" style="display:none;">
        <div class="image-container">
            <img src="attendance_vs_math_is_black_hispanic_regplot=True.png" alt="Image 1 description" />
        </div>

        <div class="image-container">
            <img src="attendance_vs_math_is_poverty_regplot=True.png" alt="Image 2 description" />
        </div>

        <div class="image-container">
            <img src="attendance_vs_math_high_chronic_absenteeism_regplot=True.png" alt="Image 3 description" />
        </div>
    </div>

    <p id="reg_text3" style="display:none;">
        In these regressions, we look at the relationship between attendance rate and test scores while taking 
        the demographic variable into consideration. To do so, we add a third term that accounts for the combined effect of attendance rate 
        and the demographic variable.   
        <br>
        In short, we estimate the following model for each group:
        <br>
        \[score = \beta_0 + \beta_1 * attendance + \beta_2 * demographic\_variable + \beta_3 * attendance *
        demographic\_variable \]
        <br>
        The estimated regressions are:
        <br>
        \[\widehat{score} = -190 + 2.64 * attendance + 44.4 * black\_hispanic - 0.69 * attendance * black\_hispanic \]
        <br>
        \[\widehat{score} = -214 + 2.90 * attendance - 24.3 * poverty + .11 * attendance * poverty \]
        <br>
        \[\widehat{score} = -547 + 6.47 * attendance + 327 * chronic\_absenteeism - 3.6 * attendance *
        chronic\_absenteeism \]
        <br>
        In these regressions, we can see that there is a difference in strength of relationship by adding an interaction term between attendance and
        the demographic variable.  
        In particular, by looking at the terms associated with chronic absenteeism, we can see that for
        districts with a higher percent of chronically absent students, the effect of increased attendance is less pronounced. 
        This means that other factors may be affecting the poor test scores. This is most clearly seen by the difference
        in slopes in the right-most figure. The steeper slope among districts with a low % of chronically absent students
        suggests that the relationship between attendance rate and test scores is stronger among districts without chronic absenteeism.
    </p>

    <button onclick="switchImage3()" id="btn3">Show Regressions</button>

    <br>











    <!-- <div class="container">
        <figure>
            <img src="attendance_vs_math_is_black_hispanic_regplot=True.png" alt="Image 1 description" />
            <figcaption>Figure 1: Image 1 Caption</figcaption>
        </figure>

        <figure>
            <img src="attendance_vs_math_is_poverty_regplot=True.png" alt="Image 2 description" />
            <figcaption>Figure 2: Image 2 Caption</figcaption>
        </figure>

        <figure>
            <img src="attendance_vs_math_high_chronic_absenteeism_regplot=True.png" alt="Image 3 description" />
            <figcaption>Figure 3: Image 3 Caption</figcaption>
        </figure>
    </div> -->

    <!-- <h2>Interactive Map: Absenteeism in NYC Public School Districts</h2>

    <p>
        [Embed your interactive map here. You can use an iframe to embed the "nyc_absenteeism_map.html" file.]
        <iframe src="nyc_absenteeism_map.html" width="100%" height="600px" style="border:none;"></iframe>
    </p>

    <h2>Addressing the Issue: Strategies and Solutions</h2>

    <p>
        [Conclusion: Suggest potential strategies and solutions to tackle the absenteeism problem and its associated
        effects on test scores and demographic disparities.]
    </p> -->
</body>

</html>